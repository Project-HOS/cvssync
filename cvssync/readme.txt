 -----------------------------------------------------------------------------
  CvsSync ＜Windows専用＞                                                     
    CVS用 文字コード変換(EUC <-> SJIS)付きフォルダ同期ツール                  
                                                                              
                                            Copyright (C) 2002 by Project HOS 
 -----------------------------------------------------------------------------



1. はじめに

  当プログラムは、CVSにてネット上で共同開発を行うにあたり、漢字を使うにも
関わらず、knjwrp が使えない場合を想定して、なるべく快適に EUC コードを
Windows環境で扱う為の物です。
  CVS上ではEUCコードで管理している場合を前提とします。



2. 準備するもの

  Windows用の nkf32.exe が必要です。
  http://www.vector.co.jp/soft/win95/util/se031296.html
  などから入手して、nkf32.exe をパスの通ったディレクトリに置いてください。



3. インストール
  CvsSync.exe と CvsSync.cfg を適当なディレクトリにコピーしてください。
  CvsSync.cfg は設定ファイルです。必ず CvsSync.exe と同じ場所に置いて
ください。

  CvsSync.exe は実行時、自分自身のパス名の拡張子のみ .cfg にしたものを
設定ファイルとして探しに行きます。よって、CvsSync.exe をリネームして
利用する場合は CvsSync.cfg の名前も同時にリネームする必要があります。
  


4. 使い方

  まず、ネットワークのサーバー上にある CVS にアクセスして、ファイルを
チェックアウトして下さい。ここまでは通常の CVS の使い方です。
  例として、c:\home_euc 以下に CVS からチェックアウトしたファイルを置いて
作業しているとしましょう。
  このままでは c:\home_euc 以下のファイルは EUC ですので Windowsで作業する
には何かと不便ですし、Shift-JIS用のコンパイラだとエラーに
もなりかねません。
  そこで、このツールを利用します。
  まず、SJISで作業する為のディレクトリを作成してください。
  例としてここでは c:\home_sjis というディレクトリを作成したとします。

  CvsSync c:\home_euc c:\home_sjis

  を実行してください。
  第１引数は EUC ファイルのディレクトリ、第２引数は SJIS のディレクトリです。

  実行すると、両者のディレクトリ（サブディレクトリを含む）のファイルの更新
時間がチェックされ、新しいファイルを古いほうへ上書きします。
  これは双方向に作用します。
  この際、ディレクトリ名が CVS のものは無視されます。また、*.obj など不要な
ファイルのコピーを防ぐ為登録された拡張子のものしかコピーしません。
  テキストファイルは nkf32 を呼び出し自動的に文字コード変換が行われます。
  この際、タイムスタンプ情報は継承されます。

  これで、文字コードが SJISとなったディレクトリのミラーが c:\home_sjis 以下に
出来上がりますので、c:\home_sjis 以下で編集作業を行ってください。

  作業が終わりましたらすかさずもう一度

    CvsSync c:\home_euc c:\home_sjis

  を実行します。
  これで、c:\home_sjis 以下で更新されたファイルが c:\home_euc 以下にも反映
されます。
  この後、CVSを用いてコミットなどを行ってください。

  要は、CVSの操作の後と、再びCVSを操作する前に実行すればOKとなります。

  ショートカットなど作成してデスクトップにでも張っておけば、クリック一発で
EUCディレクトリとSJISディレクトリの同期が取られます。
  WinCvs などと組み合わせればそれなりに快適かと思います。



5. 高度な使い方

  高度というほどでも無いですが、CvsSync.cfg の中を書き換えると、テキスト
及び、バイナリ判定の拡張子を編集できます。
  将来追加予定のものも混ざっていますが、現在利用できるのは nkf32 に渡す
オプションの一部と、拡張子判定だけです。なお、拡張子判定にワイルドカード
などは使えません。
  なお、現在のところ無視するディレクトリは "CVS" のみ、拡張子無しの
"makefile" は強制的にテキストファイルとして見なされる仕様です。



6. 利用条件

  利用にあたり特に制約はありません。再配布なども自由に行うことが出来ます。
  ただし著作権は Project HOS が保持しますので、著作権法に基づいて
扱ってください。



7. 免責

  本ソフトウェアの利用によって発生するいかなる損害も作者は責任を
負いません。また、サポートの義務もありません。



8. Project HOS のご紹介

  Project HOS は μITRON仕様OS Hyper Operating System V3 及び V4 の
開発のためインターネット上の有志で結成されたグループです。

  http://sourceforge.jp/projects/hos

  に場をお借りして活動中です。是非お立ち寄りください。
  興味のある方ならどなたでもご参加いただけます。

  本ソフトウェアは、HOS-V4 の開発にあたり、Windows上でCVSを使っている
 Ryuz が、その便宜のため独断と偏見で作成したものです (^^;;



9. おまけ

   最後に小ネタを１つ。
   私が、ディレクトリを丸ごと、リームーバルメディアで持ち歩くときの
 バッチファイルです。

   lha32 u d:\cvs_home.lzh c:\home\ *.* -x -r2
   lha32 x d:\cvs_home.lzh c:\home\ *.*

  実行には lha32.exe が必要です。上記コマンドを実行すると、c:\home 以下を
Dドライブのアーカイブと日付の新しいものだけを交換して同期を取ってくれます。
  そのままコピーしたり、フォルダ同期ソフトやブリーフケースと言う手もあるのですが、
Windows2000で書き込んだファイルをWindows95/98系で読み込むと 8+3 形式のファイルが
すべて大文字に化けてしまうと言う有名な問題がありまして、回避の為にアーカイブ化
しています。
  こういったバッチファイルで、ディレクトリを持ち歩きつつ、快適に作業しようと
企てております。



 -----------------------------------------------------------------------------
  Copyright (C) 2002 by Project HOS                                           
 -----------------------------------------------------------------------------
